language: cpp

os:
  - linux

dist: trusty
sudo: required

compiler: 
     - gcc

# whitelist
branches:
  only:
    - master

  
install:
  - echo $TRAVIS_OS_NAME
  - if [ "$TRAVIS_OS_NAME" == "linux" ]; then sudo apt-get dist-upgrade; fi
  - if [ "$TRAVIS_OS_NAME" == "linux" ]; then sudo apt-get --purge remove gcc g++ cpp binutils; fi
  - if [ "$TRAVIS_OS_NAME" == "linux" ]; then sudo add-apt-repository -y ppa:jonathonf/gcc-7.1; fi
  - if [ "$TRAVIS_OS_NAME" == "linux" ]; then sudo add-apt-repository -y ppa:jonathonf/nvptx-tools; fi
  - if [ "$TRAVIS_OS_NAME" == "linux" ]; then sudo apt-get update -qq; fi
  - if [ "$TRAVIS_OS_NAME" == "linux" ]; then apt show g++-7; fi
  - if [ "$TRAVIS_OS_NAME" == "linux" ]; then sudo apt-get install gcc-7 g++-7 nvptx-tools cpp libmpfr4 binutils; fi
  - if [ "$TRAVIS_OS_NAME" == "linux" ]; then sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-7.1 20; fi
  - if [ "$TRAVIS_OS_NAME" == "linux" ]; then sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-7.1 20; fi
  - if [ "$TRAVIS_OS_NAME" == "linux" ]; then sudo update-alternatives --config gcc; fi
  - if [ "$TRAVIS_OS_NAME" == "linux" ]; then sudo update-alternatives --config g++; fi
  - if [ "$TRAVIS_OS_NAME" == "linux" ]; then sudo apt-get remove -qq cmake cmake-data; fi
  - if [ "$TRAVIS_OS_NAME" == "linux" ]; then sudo apt-get install cmake cmake-data; fi
  
script:
  - pwd
  - which gcc
  - gcc --version
  - which g++
  - g++ --version
  - which gcc-7
  - locate gcc-7
  - mkdir build && cd build
  - cmake ..
  - make 
  #- ctest --output-on-failure


 